(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{13:function(e,t,a){e.exports=a(19)},18:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),o=a.n(c),l=(a(18),a(11)),i=a(2),s=a(1),u=a(8),m=a.n(u);var p=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("a",{href:"./",className:"header__link"},r.a.createElement("img",{src:m.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u0430\u0439\u0442\u0430",className:"header__logo"}))," ")},d=r.a.createContext();var f=function(e){var t=e.card,a=e.onCardClick,n=e.onCardLike,c=e.onCardDelete,o=r.a.useContext(d)._id,l=t.owner._id===o,i=t.likes.some((function(e){return e._id===o}));return r.a.createElement("li",{className:"places__items"},r.a.createElement("img",{src:t.link,alt:"\u041b\u0443\u0447\u0448\u0430\u044f \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044f ".concat(t.name),className:"places__image",onClick:function(){a(t)}}),r.a.createElement("div",{className:"places__name"},r.a.createElement("h2",{className:"places__title"},t.name),r.a.createElement("div",{className:"places__like"},r.a.createElement("button",{className:"button places__button-like ".concat(i?"places__button-like_enabled":""),type:"button","aria-label":"\u041f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043b\u0430\u0439\u043a \u043c\u0435\u0441\u0442\u0443",onClick:function(){n(t)}}),r.a.createElement("p",{className:"places__like-counter"},t.likes.length))),l?r.a.createElement("button",{className:"button places__button-delete",type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",onClick:function(){c(t)}}):"")};var h=function(e){var t=e.onEditAvatar,a=e.onEditProfile,n=e.onAddPlace,c=e.onCardClick,o=e.cards,l=e.onCardLike,i=e.onCardDelete,s=e.isCardsLoading,u=r.a.useContext(d),m=u.name,p=u.about,h=u.avatar;return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("button",{type:"button",onClick:t,className:"button button_non-opacity profile__button-avatar"},r.a.createElement("img",{className:"profile__avatar",src:h,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("h1",{className:"profile__user-name"},m),r.a.createElement("button",{className:"button profile__user-edit-button",onClick:a,type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),r.a.createElement("p",{className:"profile__user-job"},p)),r.a.createElement("button",{className:"button profile__add-button",type:"button",onClick:n,"aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e"})),r.a.createElement("section",{className:"places"},r.a.createElement("ul",{className:"places__cards"},s?r.a.createElement("div",{className:"places__loading-spinner"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)):o.map((function(e){return r.a.createElement(f,{key:e._id,card:e,onCardLike:l,onCardDelete:i,onCardClick:c})})))))};var _=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var b=function(e){var t=e.card,a=e.onClose;return r.a.createElement("section",{className:"popup popup_image-places ".concat(t.isOpen?"popup_opened":"")},r.a.createElement("div",{onClick:a,className:"popup__overlay popup__overlay_image-places"}),r.a.createElement("figure",{className:"popup__places"},r.a.createElement("img",{src:t.link,alt:"\u041b\u0443\u0447\u0448\u0430\u044f \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044f ".concat(t.name),className:"popup__places-image"}),r.a.createElement("figcaption",{className:"popup__places-title"},t.name),r.a.createElement("button",{className:"button popup__close-button popup__close-button_image-places",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",onClick:a})))},v=a(9),E=a(10),g=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(v.a)(this,e),this._url=a,this._headers=n}return Object(E.a)(e,[{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._url,"cards"),{headers:this._headers}).then((function(t){return e._handleResponse(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"users/me"),{headers:this._headers}).then((function(t){return e._handleResponse(t)}))}},{key:"setUserInfo",value:function(e){var t=this;return fetch("".concat(this._url,"users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return t._handleResponse(e)}))}},{key:"addCard",value:function(e){var t=this;return fetch("".concat(this._url,"cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return t._handleResponse(e)}))}},{key:"removeCard",value:function(e){var t=this;return fetch("".concat(this._url,"cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._handleResponse(e)}))}},{key:"addLike",value:function(e){var t=this;return fetch("".concat(this._url,"cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return t._handleResponse(e)}))}},{key:"removeLike",value:function(e){var t=this;return fetch("".concat(this._url,"cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._handleResponse(e)}))}},{key:"changeAvatar",value:function(e){var t=this;return fetch("".concat(this._url,"users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then((function(e){return t._handleResponse(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){var a=this;return fetch("".concat(this._url,"cards/likes/").concat(e),{method:t?"PUT":"DELETE",headers:this._headers}).then((function(e){return a._handleResponse(e)}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14/",headers:{authorization:"868762c3-88e2-4bf0-b9ab-a6e82ee7a617","Content-Type":"application/json"}}),C=a(4);function O(){var e=Object(n.useState)({}),t=Object(s.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)({}),o=Object(s.a)(c,2),l=o[0],u=o[1],m=Object(n.useState)({}),p=Object(s.a)(m,2),d=p[0],f=p[1],h=Object(n.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(e),u(t),f(a)}),[r,u,f]);return{values:a,handleChange:function(e){var t=e.target,n=t.name,c=t.value;r(Object(i.a)(Object(i.a)({},a),{},Object(C.a)({},n,c))),u(Object(i.a)(Object(i.a)({},l),{},Object(C.a)({},n,t.validationMessage))),f(t.closest("form").checkValidity())},errors:l,isValid:d,resetForm:h,setIsValid:f}}var k=a(12),j=function(e){var t=e.changeValue,a=e.className,n=e.name,c=e.value,o=e.validationMessage,l=Object(k.a)(e,["changeValue","className","name","value","validationMessage"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",Object.assign({},l,{className:"popup__input ".concat(a),name:n,onChange:function(e){t(e)},value:c||""})),r.a.createElement("span",{className:"popup__error popup__error_visible"},o||""))},y=Object(n.forwardRef)((function(e,t){var a=e.isValid,n=void 0===a||a,c=e.name,o=e.title,l=e.children,i=e.isOpen,s=e.onClose,u=e.onSubmit,m=e.buttonText;return r.a.createElement("section",{className:"popup popup_".concat(c," ").concat(i?"popup_opened":"")},r.a.createElement("div",{onClick:s,className:"popup__overlay poup__overlay_".concat(c)}),r.a.createElement("form",{ref:t,className:"popup__form popup__form_".concat(c),name:c,action:"#",onSubmit:u,noValidate:!0},r.a.createElement("h3",{className:"popup__title"},o),r.a.createElement("fieldset",{className:"popup__input-container"},l),r.a.createElement("button",{className:"button popup__submit-button popup__button-profile ".concat(n?"":"popup__submit-button_disabled"),type:"submit",disabled:!n},m||"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),r.a.createElement("button",{className:"button popup__close-button popup__close-button_".concat(c),onClick:s,type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e"})))}));var N=function(e){var t=e.isOpen,a=e.onClose,c=e.onUpdateUser,o=e.isSending,l=Object(n.useContext)(d),i=Object(n.createRef)(),s=O(),u=s.values,m=s.handleChange,p=s.errors,f=s.isValid,h=s.setIsValid,_=s.resetForm;return Object(n.useEffect)((function(){h(i.current.checkValidity())}),[h,i]),Object(n.useEffect)((function(){l&&_(l)}),[l,_,t]),r.a.createElement(y,{ref:i,name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),c(u)},isValid:f,buttonText:o?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},r.a.createElement(j,{value:u.name,changeValue:m,className:"popup__input_type_profile-name",name:"name",type:"text",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",required:!0,minLength:"2",maxLength:"40",autoComplete:"off",validationMessage:p.name}),r.a.createElement(j,{value:u.about,changeValue:m,className:"popup__input_type_profile-status",name:"about",type:"text",placeholder:"\u041f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f",required:!0,minLength:"2",maxLength:"200",autoComplete:"off",validationMessage:p.about}))};var S=function(e){var t=e.isOpen,a=e.onClose,c=e.onUpdateAvatar,o=e.isSending,l=O(),i=l.values,s=l.handleChange,u=l.errors,m=l.isValid,p=l.resetForm;return Object(n.useEffect)((function(){p()}),[p,t]),r.a.createElement(y,{name:"avatar-change",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),c(i)},isValid:m,buttonText:o?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},r.a.createElement(j,{value:i.avatar,changeValue:s,className:"popup__input_type_place-image",name:"avatar",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,autoComplete:"off",validationMessage:u.avatar}))};var L=function(e){var t=e.isOpen,a=e.onClose,c=e.onAddPlace,o=e.isSending,l=O(),i=l.values,s=l.handleChange,u=l.errors,m=l.isValid,p=l.resetForm;return Object(n.useEffect)((function(){p()}),[p,t]),r.a.createElement(y,{name:"add-places",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),c(i)},isValid:m,buttonText:o?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},r.a.createElement(j,{value:i.name,changeValue:s,className:"popup__input_type_places-name",name:"name",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"1",maxLength:"30",autoComplete:"off",validationMessage:u.name}),r.a.createElement(j,{value:i.link,changeValue:s,className:"popup__input_type_place-image",name:"link",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,autoComplete:"off",validationMessage:u.link}))};var V=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),u=Object(s.a)(o,2),m=u[0],f=u[1],v=Object(n.useState)(!1),E=Object(s.a)(v,2),C=E[0],O=E[1],k=Object(n.useState)({}),j=Object(s.a)(k,2),V=j[0],x=j[1],T=Object(n.useState)({}),U=Object(s.a)(T,2),w=U[0],P=U[1],R=Object(n.useState)([]),A=Object(s.a)(R,2),D=A[0],M=A[1],I=Object(n.useState)({}),q=Object(s.a)(I,2),F=q[0],J=q[1],B=Object(n.useState)(!1),H=Object(s.a)(B,2),W=H[0],z=H[1],$=Object(n.useState)(!1),G=Object(s.a)($,2),K=G[0],Q=G[1],X=Object(n.useState)(!1),Y=Object(s.a)(X,2),Z=Y[0],ee=Y[1];function te(){c(!1),f(!1),O(!1),x({}),z(!1)}return Object(n.useEffect)((function(){Q(!0),g.getInitialCards().then((function(e){return M(e)})).catch((function(e){return console.error(e)})).finally((function(){return Q(!1)}))}),[]),Object(n.useEffect)((function(){g.getUserInfo().then((function(e){return P(e)})).catch((function(e){return console.error(e)}))}),[]),Object(n.useEffect)((function(){function e(e){27===e.keyCode&&te()}return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[]),r.a.createElement("div",{className:"root"},r.a.createElement("div",{className:"page"},r.a.createElement(d.Provider,{value:w},r.a.createElement(p,null),r.a.createElement(h,{onEditAvatar:function(){O(!0)},onEditProfile:function(){c(!0)},onAddPlace:function(){f(!0)},onCardClick:function(e){x(Object(i.a)(Object(i.a)({},e),{},{isOpen:!0}))},cards:D,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===w._id}));g.changeLikeCardStatus(e._id,!t).then((function(t){var a=D.map((function(a){return a._id===e._id?t:a}));M(a)})).catch((function(e){return console.error(e)}))},onCardDelete:function(e){J(e),z(!0)},isCardsLoading:K}),r.a.createElement(_,null),r.a.createElement(S,{isSending:Z,isOpen:C,onClose:te,onUpdateAvatar:function(e){ee(!0),g.changeAvatar(e).then((function(e){return P(e)})).then((function(){return te()})).finally((function(){return ee(!1)}))}}),r.a.createElement(N,{isSending:Z,isOpen:a,onClose:te,onUpdateUser:function(e){ee(!0),g.setUserInfo(e).then((function(e){return P(e)})).then((function(){return te()})).finally((function(){return ee(!1)}))}}),r.a.createElement(L,{isSending:Z,isOpen:m,onClose:te,onAddPlace:function(e){ee(!0),g.addCard(e).then((function(e){return M([e].concat(Object(l.a)(D)))})).then((function(){return te()})).finally((function(){return ee(!1)}))}}),r.a.createElement(b,{card:V,onClose:te}),r.a.createElement(y,{isEnabled:"true",name:"card-delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:W,onClose:te,onSubmit:function(e){ee(!0),e.preventDefault(),g.removeCard(F._id).then((function(){var e=D.filter((function(e){return e!==F}));M(e)})).then((function(){return z(!1)})).finally((function(){return ee(!1)}))},buttonText:Z?"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...":"\u0414\u0430"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a.p+"static/media/logo.855a8c98.svg"}},[[13,1,2]]]);
//# sourceMappingURL=main.a1621805.chunk.js.map